import{u as A,a as F,b as i,j as e,k as u,C as n,c as l,D as v,l as R,e as h,f as o,g as y,M as j,B as x,i as w,P as $,T as k}from"./index-CFejLDhn.js";function I(){A(),F();const{data:r=[]}=i({queryKey:["/api/students/children"]}),{data:m=[]}=i({queryKey:["/api/fees/children"]}),{data:C=[]}=i({queryKey:["/api/attendance/children"]});i({queryKey:["/api/results/children"]});const{data:S=[]}=i({queryKey:["/api/notices/parent"]}),p=m.filter(s=>s.status==="pending").reduce((s,t)=>s+parseFloat(t.amount.toString()),0),g=r.map(s=>{const t=C.filter(d=>d.studentId===s.id),a=t.length>0?t.filter(d=>d.status==="present").length/t.length*100:0;return{...s,attendanceRate:a}}),N=S.filter(s=>s.priority==="high").slice(0,3),f=g.filter(s=>s.attendanceRate<75||m.some(t=>t.studentId===s.id&&t.status==="pending"));return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-primary text-white p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(u,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Parent Portal"}),e.jsxs("p",{className:"text-sm opacity-90",children:[r.length," ",r.length===1?"Child":"Children"," Enrolled"]})]})]})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(n,{children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"w-5 h-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending Fees"}),e.jsxs("p",{className:"text-xl font-bold",children:["$",p]})]})]})})}),e.jsx(n,{children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"w-5 h-5 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Attention Needed"}),e.jsx("p",{className:"text-xl font-bold",children:f.length})]})]})})})]}),e.jsxs(n,{children:[e.jsx(h,{className:"pb-3",children:e.jsxs(o,{className:"text-base flex items-center space-x-2",children:[e.jsx(u,{className:"w-4 h-4"}),e.jsx("span",{children:"My Children"})]})}),e.jsx(l,{className:"space-y-3",children:r.map(s=>{var b;const t=((b=g.find(c=>c.id===s.id))==null?void 0:b.attendanceRate)||0,a=m.filter(c=>c.studentId===s.id&&c.status==="pending").reduce((c,P)=>c+parseFloat(P.amount.toString()),0),d=t<75||a>0;return e.jsxs("div",{className:`p-3 rounded-lg border ${d?"border-orange-200 bg-orange-50 dark:bg-orange-950":"border-gray-200 bg-gray-50 dark:bg-gray-800"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Class ",s.class," • Roll: ",s.rollNumber]})]}),d&&e.jsx(y,{variant:"destructive",className:"text-xs",children:"Attention"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Attendance"}),e.jsxs("p",{className:`font-medium ${t>=75?"text-green-600":"text-red-600"}`,children:[t.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Pending Fees"}),e.jsxs("p",{className:`font-medium ${a===0?"text-green-600":"text-red-600"}`,children:["$",a]})]})]}),e.jsx("div",{className:"mt-2 flex space-x-2",children:e.jsx(j,{title:`${s.name}'s Report`,text:`Attendance: ${t.toFixed(1)}%, Pending Fees: $${a}`,children:e.jsx(x,{variant:"ghost",size:"sm",className:"text-xs h-6",children:"Share Report"})})})]},s.id)})})]}),p>0&&e.jsxs(n,{children:[e.jsx(h,{className:"pb-3",children:e.jsxs(o,{className:"text-base flex items-center space-x-2",children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{children:"Pending Payments"})]})}),e.jsx(l,{className:"space-y-3",children:m.filter(s=>s.status==="pending").slice(0,4).map(s=>{const t=r.find(a=>a.id===s.studentId);return e.jsxs("div",{className:"flex justify-between items-center p-3 bg-red-50 dark:bg-red-950 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.feeType}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t==null?void 0:t.name," • Due: ",s.dueDate?new Date(s.dueDate).toLocaleDateString():"ASAP"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-red-600",children:["$",s.amount]}),e.jsx(j,{title:"Fee Payment Required",text:`${t==null?void 0:t.name} - ${s.feeType}: $${s.amount}`,children:e.jsx(x,{variant:"ghost",size:"sm",className:"text-xs h-6",children:"Share"})})]})]},s.id)})})]}),N.length>0&&e.jsxs(n,{children:[e.jsx(h,{className:"pb-3",children:e.jsxs(o,{className:"text-base flex items-center space-x-2",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:"Important Notices"})]})}),e.jsx(l,{className:"space-y-3",children:N.map(s=>e.jsx("div",{className:"p-3 border-l-4 border-red-500 bg-red-50 dark:bg-red-950",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:s.content})]}),e.jsx(y,{variant:"destructive",className:"ml-2 text-xs",children:s.priority})]})},s.id))})]}),e.jsxs(n,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(o,{className:"text-base",children:"Quick Actions"})}),e.jsx(l,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(x,{variant:"outline",className:"h-auto p-3 flex flex-col space-y-1",children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:"Contact School"})]}),e.jsxs(x,{variant:"outline",className:"h-auto p-3 flex flex-col space-y-1",children:[e.jsx(w,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:"View Notices"})]}),e.jsxs(j,{title:"Family Report Summary",text:`Total pending fees: $${p}. ${f.length} children need attention.`,className:"h-auto p-3 flex flex-col space-y-1 border rounded-lg cursor-pointer hover:bg-muted/50",children:[e.jsx(k,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:"Share Summary"})]}),e.jsxs(j,{title:"Children Overview",text:`Monitoring ${r.length} children. Overall status and attendance tracking.`,className:"h-auto p-3 flex flex-col space-y-1 border rounded-lg cursor-pointer hover:bg-muted/50",children:[e.jsx(u,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:"Share Overview"})]})]})})]}),e.jsx(n,{children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"School Emergency Contact"}),e.jsxs(x,{className:"w-full",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Call School Office"]})]})})})]})]})}export{I as default};
